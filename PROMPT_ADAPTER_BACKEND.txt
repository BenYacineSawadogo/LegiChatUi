================================================================================
PROMPT POUR CLAUDE CODE - SESSION BACKEND
================================================================================

CONTEXTE:
---------
J'ai un frontend Angular 20 pour Legichat (chatbot juridique s√©n√©galais) qui est d√©j√† fonctionnel avec une API mock. J'ai aussi un backend existant que je dois adapter pour qu'il soit compatible avec ce frontend.

Le frontend est dans le dossier: /home/user/LegiChatUi

FICHIER √Ä LIRE EN PRIORIT√â:
---------------------------
üìÑ /home/user/LegiChatUi/FRONTEND_TO_BACKEND_SPECS.md

Ce fichier contient TOUTES les sp√©cifications d√©taill√©es:
- Architecture du frontend
- Mod√®les de donn√©es TypeScript
- Contrats API (format exact des requ√™tes/r√©ponses)
- Flux de communication
- Exemples de code

T√ÇCHE PRINCIPALE:
-----------------
1. LIS le fichier FRONTEND_TO_BACKEND_SPECS.md en entier

2. ANALYSE mon backend actuel et identifie:
   - Quelle est sa stack technique ?
   - O√π se trouve le code existant ?
   - Quels sont les endpoints actuels ?
   - Comment est structur√© le projet ?

3. ADAPTE mon backend pour qu'il soit compatible avec le frontend:

   a) Cr√©er/Modifier l'endpoint POST /api/chat qui:
      - Accepte: { conversationId: string, message: string }
      - Retourne: { id: string, conversationId: string, content: string, role: "assistant", timestamp: string }
      - Appelle mon IA/LLM pour g√©n√©rer la r√©ponse
      - G√®re l'historique conversationnel pour le contexte

   b) Configurer CORS pour autoriser http://localhost:4200

   c) S'assurer que le format timestamp est ISO 8601

   d) Impl√©menter la gestion d'erreurs appropri√©e

4. TESTE l'endpoint avec curl pour v√©rifier qu'il fonctionne

5. DONNE-MOI l'URL finale √† configurer dans le frontend


CONTRAINTES IMPORTANTES:
------------------------
‚úÖ Le frontend g√©n√®re les IDs de conversation ‚Üí le backend DOIT les accepter (ne pas g√©n√©rer les siens)
‚úÖ Le backend g√©n√®re les IDs des messages assistant uniquement
‚úÖ Le frontend envoie UN message √† la fois ‚Üí le backend doit g√©rer l'historique pour le contexte IA
‚úÖ Le timestamp DOIT √™tre au format ISO 8601: new Date().toISOString()
‚úÖ Le champ "role" dans la r√©ponse DOIT toujours √™tre "assistant"
‚úÖ Le conversationId dans la r√©ponse DOIT √™tre identique √† celui de la requ√™te

EXEMPLE DE REQU√äTE/R√âPONSE ATTENDUE:
------------------------------------
Requ√™te:
POST /api/chat
{
  "conversationId": "conv-1729459200-k8j3h2l9q",
  "message": "Quelle est la proc√©dure pour cr√©er une entreprise au S√©n√©gal ?"
}

R√©ponse:
200 OK
{
  "id": "msg-1729459201-xyz789",
  "conversationId": "conv-1729459200-k8j3h2l9q",
  "content": "Pour cr√©er une entreprise au S√©n√©gal, vous devez...",
  "role": "assistant",
  "timestamp": "2025-10-22T14:30:01.000Z"
}


ORDRE D'EX√âCUTION:
------------------
1. Lis FRONTEND_TO_BACKEND_SPECS.md
2. Explore mon backend existant
3. Identifie les modifications n√©cessaires
4. Impl√©mente les changements
5. Configure CORS
6. Teste avec curl
7. Commit et push les changements


R√âSULTAT ATTENDU:
-----------------
√Ä la fin, je veux:
- ‚úÖ Un endpoint POST /api/chat fonctionnel et compatible
- ‚úÖ CORS configur√©
- ‚úÖ Test curl r√©ussi
- ‚úÖ L'URL du backend √† utiliser dans le frontend
- ‚úÖ Instructions pour connecter le frontend (si n√©cessaire)


COMMENCE PAR:
-------------
"Je vais lire le fichier de sp√©cifications et analyser ton backend pour l'adapter au frontend Legichat."

================================================================================
